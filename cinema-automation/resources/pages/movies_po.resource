*** Settings ***
Documentation    Page Object ‚Äì listagem / busca de filmes e navega√ß√£o para detalhes.

Resource         ../base.resource

*** Keywords ***
Ir para P√°gina de Filmes em Cartaz
    [Documentation]   Abre grid de filmes pelo menu.
    Click                      css=header a[href="/movies"]
    Wait For Elements State    css=.movies-container    visible

Selecionar Filme
    [Documentation]    Clica em ‚ÄúVer Detalhes‚Äù conforme √≠ndice de card.
    [Arguments]                ${indice}
    ${seletor}=                Set Variable                css=div.movie-card:nth-child(${indice}) > div:nth-child(2) > a:nth-child(5)
    Wait For Elements State    ${seletor}                  visible
    Get Text                   ${seletor}    ==            Ver Detalhes
    Click                      ${seletor}
    Wait For Elements State    css=.movie-detail-header    visible

Buscar Filmes e Validar
    [Documentation]    Executa busca para lista de t√≠tulos em loop.
    [Arguments]    @{titulos}
    FOR    ${titulo}    IN    @{titulos}
        Preencher E Validar Busca    ${titulo}
    END

Preencher E Validar Busca
    [Documentation]    Busca t√≠tulo espec√≠fico e valida resultado.
    [Arguments]    ${titulo}

    Clear Text                        css=.search-box input
    Fill Text                         css=.search-box input    ${titulo}
    Wait Until Keyword Succeeds       5x    1s                 Wait For Elements State    css=.loading-spinner    hidden

    ${existe}=    Run Keyword And Return Status    Wait For Elements State    css=.movie-card h3    visible    timeout=3s

    IF    ${existe}
        ${resultado}=    Get Text    css=.movie-card h3
        Log To Console  üîç Filme encontrado: ${resultado}
        Should Contain    ${resultado}    ${titulo}
    ELSE
        Log To Console    ‚ö†Ô∏è Nenhum filme encontrado para: ${titulo}    WARN
    END
    